# 关于RinaChanBoard Operation Center

这是为738NGX's RinaChanBoard特制的微信上位机小程序.

## 📝 技术相关

### 表情的表示与同步方式

小程序设置了一个16*18的全局数组cells,用于记录每一个位置上LED灯的开闭.同时设置了事件监听器,保证每个页面上的表情显示统一.

虽然很有可能会出现多个上位机控制同一个下位机的情况,但是在现阶段版本中并没有添加从下位机同步当前显示表情到下位机的功能.

### 与下位机通讯方式

使用TCP协议,借助巴法云物联网平台实现上位机-下位机之间的通信.当前端发生用户交互时,上位机将适当的指令消息推送到用户选定的topic(即不同的控制机型),下位机接受到来自topic中继的消息后,驱动WS2812B LED灯珠,做出表情变化.

### 消息类型

- 自定义表情消息:长度为72的十六进制字符串,可以转换为长度为288的二进制字符串,对应每一个LED灯的开闭信息.
- 预设语音播放消息:长度为16的字符串,记录了语音的id.下位机借助这个id从`std::map`中获取映射的语音表情数据并进行播放.
- 预设歌曲播放消息:长度为19的字符串,记录了歌曲的id.下位机借助这个id从`std::map`中获取映射的歌曲表情数据并进行播放.

## 🕊️ 更新路线图

- 近期可能会考虑重写歌曲播放逻辑.现在的歌曲播放完全照搬语音的播放逻辑,但是歌曲至少得实现暂停的功能吧(乐)

## ✅ 版本更新记录

加粗部分为重大更新.

| 版本号    | 版本说明                                                     |
| --------- | ------------------------------------------------------------ |
| 0.0.1     | 第一个测试版本,包含了脱机的自定义表情前端交互.               |
| 0.0.2     | 使用TCP协议完成了和下位机的通讯功能,可以正常完成消息收发.    |
| 0.0.3     | 首页现在可以显示下位机的连接情况;自定义表情现在已经可以控制脸颊. |
| 0.0.4     | 增加了脱机的预设语音前端交互,虽然现在只包含了一条来自LLAS的测试语音. |
| 0.0.5     | 现在已经可以在首页上选择不同的控制机型(也可以不选择).        |
| 0.0.6     | 预设语音的播放消息现在已经可以同步到下位机.                  |
| 0.0.7     | 增加了脱机的预设歌曲前端交互,包含了测试歌曲Love U my friends(short ver.). |
| 0.0.8     | 预设歌曲的播放消息现在已经可以同步到下位机.                  |
| 0.0.9     | 增加了两条预设语音.                                          |
| **0.1.0** | **第一个功能基本完备的大版本更新,包括了连接控制/自定义表情/预设语音播放/预设歌曲播放的功能.** |



